<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Implementing_API_X_Endpoints | @evolutius/apix</title><meta name="description" content="Documentation for @evolutius/apix"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><link rel="stylesheet" href="../assets/typedoc-github-style.css"/></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">@evolutius/apix</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">@evolutius/apix</a></li><li><a href="Implementing_API_X_Endpoints.html">Implementing_API_X_Endpoints</a></li></ul></div><div class="tsd-panel tsd-typography"><p>API-X Endpoints are routes that handle an operation of an HTTP RESTful API, such a getting users data, creating a new post, among others.</p>
<a id="md:api-x-method-interface" class="tsd-anchor"></a><h2 class="tsd-anchor-link">API-X Method Interface<a href="#md:api-x-method-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="ts"><span class="hl-8">export</span><span class="hl-1"> </span><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-3">ApiXMethod</span><span class="hl-1">&lt;</span><br/><span class="hl-1">  </span><span class="hl-3">QuerySchema</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-3">ApiXRequestInputSchema</span><span class="hl-1"> = </span><span class="hl-3">Record</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-3">never</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">  </span><span class="hl-3">BodySchema</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-3">ApiXRequestInputSchema</span><span class="hl-1"> = </span><span class="hl-3">Record</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-3">never</span><span class="hl-1">&gt;</span><br/><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">entity</span><span class="hl-1">?: </span><span class="hl-3">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">method</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">requestHandler</span><span class="hl-1">: </span><span class="hl-3">ApiXRequestHandler</span><span class="hl-1">&lt;</span><span class="hl-3">QuerySchema</span><span class="hl-1">, </span><span class="hl-3">BodySchema</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">httpMethod</span><span class="hl-1">?: </span><span class="hl-7">&#39;GET&#39;</span><span class="hl-1"> | </span><span class="hl-7">&#39;POST&#39;</span><span class="hl-1"> | </span><span class="hl-7">&#39;PUT&#39;</span><span class="hl-1"> | </span><span class="hl-7">&#39;DELETE&#39;</span><span class="hl-1"> | </span><span class="hl-7">&#39;PATCH&#39;</span><span class="hl-1"> | </span><span class="hl-7">&#39;ALL&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">queryParameters</span><span class="hl-1">?: </span><span class="hl-3">ReadonlyArray</span><span class="hl-1">&lt;</span><span class="hl-3">ApiXUrlQueryParameter</span><span class="hl-1">&lt;</span><span class="hl-3">unknown</span><span class="hl-1">&gt;&gt;;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">jsonBodyValidator</span><span class="hl-1">?: </span><span class="hl-3">ApiXHttpBodyValidator</span><span class="hl-1">&lt;</span><span class="hl-3">BodySchema</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">jsonBodyRequired</span><span class="hl-1">?: </span><span class="hl-3">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">characteristics</span><span class="hl-1">: </span><span class="hl-3">ReadonlySet</span><span class="hl-1">&lt;</span><span class="hl-3">ApiXMethodCharacteristic</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:overview" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Overview<a href="#md:overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>ApiXMethod</code> interface is used to define a route or endpoint for your HTTP RESTful API. Generally speaking, methods should be designed with the following key principles in mind:</p>
<ol>
<li>An endpoint should be scoped; developers should not have multiple operations under the same endpoint and should avoid complicating the handling logic.</li>
<li>Endpoints should have clear access expectations; only requestors with access should ever even reach an entry point for the method.
<ul>
<li>The method must handle resource scoping (more on this later).</li>
</ul>
</li>
<li>Any input data (URL query parameters or HTTP Body) is validated and processed <em>before</em> handling a request.</li>
<li>Any input data should have a clear shape and presence expectations <em>during</em> the handling of the request.</li>
</ol>
<a id="md:defining-an-endpoint" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Defining an Endpoint<a href="#md:defining-an-endpoint" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>There are two properties that define the endpoint, <code>entity</code>, and <code>method</code>. <em>Entity</em> is used to define a scope for your endpoint, e.g. <code>users</code> or <code>posts</code>, whereas <em>Method</em> defines an operation within the scope, e.g. <code>create</code>, <code>delete</code>, or <code>update</code>. Entities are optional, however, and so developers can define their endpoints how they see fit. The resulting endpoint is:</p>
<ul>
<li><code>/&lt;endpoint&gt;/&lt;method&gt;</code>, if <code>entity</code> is a non-empty string; or,</li>
<li><code>/&lt;method&gt;</code>, if there's no entity.</li>
</ul>
<p>To choose appropriate entites and method names, one can think of two questions:</p>
<ol>
<li>What is the operation being applied to?
<ul>
<li>This defines the <code>entity</code>.</li>
</ul>
</li>
<li>What operation is being applied?
<ul>
<li>This defines the <code>method</code>.</li>
</ul>
</li>
</ol>
<p>For example, an operation to create a new post entry can have an entity of <code>posts</code> and method of <code>create</code> or <code>new</code>.</p>
<p>However, when getting specific resources, developers can also use parameterized methods, e.g.:</p>
<ul>
<li><code>/users/{id}</code>, where <code>entity</code> is <code>users</code> and <code>method</code> is <code>{id}</code>. This method will match requests such as <code>/user/01234567</code>, which is typical when getting data for a user with a given ID.</li>
</ul>
<a id="md:url-query-parameters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">URL Query Parameters<a href="#md:url-query-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>ApiXMethod</code> interface uses templates to allow the definition of the shape of input URL query parameters. Generally speaking, there are two steps that need to be taken:</p>
<ol>
<li>Define input shape of the URL Query parameters; and,</li>
<li>Define each parameter.</li>
</ol>
<p>An interface is used to define the schema of the URL parameters:</p>
<pre><code class="ts"><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-3">SearchPostsSchema</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-3">ApiXRequestInputSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">searchTerm</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">;  </span><span class="hl-9">/// Search term to use</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">sortBy</span><span class="hl-1">?: </span><span class="hl-3">PostKey</span><span class="hl-1">;  </span><span class="hl-9">/// A key to sort by</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">authorName</span><span class="hl-1">?: </span><span class="hl-3">string</span><span class="hl-1">;  </span><span class="hl-9">/// An author for the posts</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">dateRange</span><span class="hl-1">: [</span><span class="hl-3">Date</span><span class="hl-1">, </span><span class="hl-3">Date</span><span class="hl-1">];  </span><span class="hl-9">/// The date range of the post.</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">tags</span><span class="hl-1">?: </span><span class="hl-3">ReadonlyArray</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;;  </span><span class="hl-9">/// A list of tags the post must contain</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The schema definition must extend the <code>ApiXRequestInputSchema</code> interface. With this, we define that when the endpoint receives a request, only these URL query parameters will be used. Furthermore, only <code>searchTerm</code> is required, and additional parameters are optional.</p>
<p>In addition to defining the schema, the parameters are defined using the <code>queryParameters</code> array of <code>ApiXMethod</code>. In said definition, developers can specify a validator and processor objects. These objects will do exactly as their name implies, validate and process query parameters.</p>
<p>As an example, let's write a validator and processor for the <code>tags</code> query parameter:</p>
<pre><code class="ts"><span class="hl-9">/**</span><br/><span class="hl-9"> * A validator object that succeeds for correctly defined comma-separated</span><br/><span class="hl-9"> * arrays for URL parameters. Example:</span><br/><span class="hl-9"> * `/entity/endpoint?array=value0,value1,value2,value3`</span><br/><span class="hl-9"> */</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-3">CommaSeparatedArrayUrlQueryParameterValidator</span><span class="hl-1"> </span><span class="hl-6">implements</span><span class="hl-1"> </span><span class="hl-3">ApiXUrlQueryParameterValidator</span><span class="hl-1"> {</span><br/><br/><span class="hl-1">  </span><span class="hl-5">isValid</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-4">value</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">): </span><span class="hl-3">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-9">/// Matches only alphanumeric, case-insensitive, comma-separated values</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-0">regex</span><span class="hl-1"> =</span><span class="hl-11"> /</span><span class="hl-12">^</span><span class="hl-13">[</span><span class="hl-11">a-zA-Z0-9</span><span class="hl-13">]</span><span class="hl-14">+</span><span class="hl-13">(</span><span class="hl-11">,</span><span class="hl-13">[</span><span class="hl-11">a-zA-Z0-9</span><span class="hl-13">]</span><span class="hl-14">+</span><span class="hl-13">)</span><span class="hl-14">*</span><span class="hl-12">$</span><span class="hl-11">/</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-8">return</span><span class="hl-1"> </span><span class="hl-4">regex</span><span class="hl-1">.</span><span class="hl-5">test</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>This validator uses a simple regular expression pattern to validate that the value is an alphanumeric case-insensitve comma-separated list of strings. This will suffice for a list of tags. Now, a processor can be implemented:</p>
<pre><code class="ts"><span class="hl-9">/**</span><br/><span class="hl-9"> * A processor object that converts a valid list of comma-separated values</span><br/><span class="hl-9"> * to a readonly array.</span><br/><span class="hl-9"> */</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-3">CommaSeparatedArrayUrlQueryParameterProcessor</span><span class="hl-1"> </span><span class="hl-6">implements</span><span class="hl-1"> </span><span class="hl-3">ApiXUrlQueryParameterProcessor</span><span class="hl-1">&lt;</span><span class="hl-3">ReadyonlyArray</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;&gt; {</span><br/><br/><span class="hl-1">  </span><span class="hl-5">process</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-4">value</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">): [</span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-3">ReadonlyArray</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;] {</span><br/><span class="hl-1">    </span><span class="hl-8">return</span><span class="hl-1"> [</span><span class="hl-4">name</span><span class="hl-1">, </span><span class="hl-4">value</span><span class="hl-1">.</span><span class="hl-5">split</span><span class="hl-1">(</span><span class="hl-7">&#39;,&#39;</span><span class="hl-1">)];</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>First thing to note is that the <code>ApiXUrlQueryParameterProcessor</code> is a templated interface that returns a key-value tuple, where the value can have any type. This makes it useful to define parameters in the Schema having any type desired and the processor handles the conversion into the type. In this case, the parameter value would a string such as <code>'value0,value1,value2'</code>, but the output of the processor is a <code>ReadonlyArray&lt;string&gt;</code>, namely <code>['value0', 'value1', value2']</code>, which matches the type of the <code>tags</code> property in the <code>SearchPostsSchema</code> interface.</p>
<p>Additionally, a processor may decide to process the name of the parameter so that developers have the additional flexibility of allowing users to specify URL query parameters using one convention, e.g., <code>/entity/method/snake_case=some_value</code>, but the schema may receive the property as <code>snakeCase</code> instead by modifying it in the processor.</p>
<p>Finally, with a validator and processor implemented, the parameters can be defined in the method:</p>
<pre><code class="ts"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-0">searchPostsMethod</span><span class="hl-1">: </span><span class="hl-3">ApiXMethod</span><span class="hl-1">&lt;</span><span class="hl-3">SearchPostsSchema</span><span class="hl-1">&gt; = {</span><br/><span class="hl-1">  </span><span class="hl-4">entity:</span><span class="hl-1"> </span><span class="hl-7">&#39;posts&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-7">&#39;search&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">queryParameters:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-9">/* the processor will convert `search_query` into `searchTerm` */</span><br/><span class="hl-1">    </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ApiXUrlQueryParameter</span><span class="hl-1">(</span><span class="hl-7">&#39;search_query&#39;</span><span class="hl-1">, </span><span class="hl-4">someValidator</span><span class="hl-1">, </span><span class="hl-4">someProcessor</span><span class="hl-1">, </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-9">/* required */</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ApiXUrlQueryParameter</span><span class="hl-1">(</span><span class="hl-7">&#39;sort_by&#39;</span><span class="hl-1">, </span><span class="hl-4">someValidator</span><span class="hl-1">, </span><span class="hl-4">someProcessor</span><span class="hl-1">, </span><span class="hl-9">/* not required */</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ApiXUrlQueryParameter</span><span class="hl-1">(</span><span class="hl-7">&#39;author&#39;</span><span class="hl-1">, </span><span class="hl-4">someValidator</span><span class="hl-1">, </span><span class="hl-4">someProcessor</span><span class="hl-1">, </span><span class="hl-9">/* not required */</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ApiXUrlQueryParameter</span><span class="hl-1">(</span><span class="hl-7">&#39;date_range&#39;</span><span class="hl-1">, </span><span class="hl-4">someValidator</span><span class="hl-1">, </span><span class="hl-4">someProcessor</span><span class="hl-1">, </span><span class="hl-9">/* not required */</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ApiXUrlQueryParameter</span><span class="hl-1">(</span><span class="hl-7">&#39;tags&#39;</span><span class="hl-1">, </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">CommaSeparatedArrayUrlQueryParameterValidator</span><span class="hl-1">(), </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">CommaSeparatedArrayUrlQueryParameterProcessor</span><span class="hl-1">(), </span><span class="hl-9">/* not required */</span><span class="hl-1">),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">requestHandler</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-9">/* `req` has an implicit type of `ApiXRequestHandler&lt;SearchPostsSchema&gt; */</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-0">queryParameters</span><span class="hl-1"> = </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">queryParameters</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-9">/* Now each parameter in the `queryParameters` object is fully validated</span><br/><span class="hl-9">    and processed to be in its optional form */</span><br/><span class="hl-1">    </span><span class="hl-8">if</span><span class="hl-1"> (</span><span class="hl-4">queryParameters</span><span class="hl-1">.</span><span class="hl-4">tags</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">queryParameter</span><span class="hl-1">.</span><span class="hl-4">tags</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &gt; </span><span class="hl-15">0</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-9">/// do something with the tags array</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-8">return</span><span class="hl-1"> </span><span class="hl-4">someJsonObject</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><em>Note: if a validator object fails, the request will immediately fail and an unsuccessful response will be returned.</em></p>
<a id="md:validating-http-json-body" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validating HTTP JSON Body<a href="#md:validating-http-json-body" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>ApiXMethod</code> interface's second template parameter is used to define the schema of the JSON body in a similar fashion than it's done for the URL queries.</p>
<pre><code class="ts"><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-3">Post</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">content</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">authorId</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-3">CreatePostRequestSchema</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-3">ApiXRequestInputSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">post</span><span class="hl-1">: </span><span class="hl-3">Post</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-6">readonly</span><span class="hl-1"> </span><span class="hl-4">tags</span><span class="hl-1">?: </span><span class="hl-3">ReadonlyArray</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>In this case, the schema to be used is <code>CreatePostRequestSchema</code>. A <em>validator</em> can then be used to ensure each post is valid:</p>
<pre><code class="ts"><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-3">CreatePostRequestValidator</span><span class="hl-1"> </span><span class="hl-6">implements</span><span class="hl-1"> </span><span class="hl-3">ApiXHttpBodyValidator</span><span class="hl-1">&lt;</span><span class="hl-3">CreatePostRequestSchema</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-5">isValid</span><span class="hl-1">(</span><span class="hl-4">body</span><span class="hl-1">: </span><span class="hl-3">CreatePostRequestSchema</span><span class="hl-1">): </span><span class="hl-3">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-9">/// validate post here. Returning false means</span><br/><span class="hl-1">    </span><span class="hl-9">/// the body is not valid and is the request is rejected.</span><br/><span class="hl-1">    </span><span class="hl-8">return</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">} </span>
</code><button type="button">Copy</button></pre>

<p>Finally, then the method can be defined:</p>
<pre><code class="ts"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-0">createPostMethod</span><span class="hl-1">: </span><span class="hl-3">ApiXMethod</span><span class="hl-1">&lt;</span><span class="hl-3">Record</span><span class="hl-1">&lt;</span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-3">never</span><span class="hl-1">&gt;, </span><span class="hl-3">CreatePostRequestSchema</span><span class="hl-1">&gt; = {</span><br/><span class="hl-1">  </span><span class="hl-4">entity:</span><span class="hl-1"> </span><span class="hl-7">&#39;posts&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-7">&#39;new&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">jsonBodyRequired:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">,  </span><span class="hl-9">/// This endpoint requires that the body be present,</span><br/><span class="hl-1">  </span><span class="hl-4">jsonBodyValidator:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">CreatePostRequestValidator</span><span class="hl-1">(),</span><br/><span class="hl-1">  </span><span class="hl-5">requestHandler</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-9">/* `req` has an implicit type of `ApiXRequestHandler&lt;Record&lt;string, never&gt;, CreatePostRequestSchema&gt; */</span><br/><span class="hl-1">    </span><span class="hl-9">/// jsonBody is of type `CreatePostRequestSchema`</span><br/><br/><span class="hl-1">    </span><span class="hl-9">/// Since `jsonBodyRequired` is `true`, it&#39;s guaranteed</span><br/><span class="hl-1">    </span><span class="hl-9">/// that this will have a value.</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-0">jsonBody</span><span class="hl-1"> = </span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">jsonBody</span><span class="hl-1">!;</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-0">response</span><span class="hl-1"> = </span><span class="hl-8">await</span><span class="hl-1"> </span><span class="hl-5">newPost</span><span class="hl-1">(</span><span class="hl-4">jsonBody</span><span class="hl-1">.</span><span class="hl-4">post</span><span class="hl-1">, ...);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-8">return</span><span class="hl-1"> </span><span class="hl-4">someJsonObject</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><em>Note: since this method doesn't require URL Query parameters, that template is set to <code>Record&lt;string, never&gt;</code> and it will not be present.</em></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:api-x-method-interface"><span>API-<wbr/>X <wbr/>Method <wbr/>Interface</span></a><ul><li><a href="#md:overview"><span>Overview</span></a></li><li><a href="#md:defining-an-endpoint"><span>Defining an <wbr/>Endpoint</span></a></li><li><a href="#md:url-query-parameters"><span>URL <wbr/>Query <wbr/>Parameters</span></a></li><li><a href="#md:validating-http-json-body"><span>Validating HTTP JSON <wbr/>Body</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>@evolutius/apix</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a> with <a href="https://github.com/KillerJulian/typedoc-github-theme" target="_blank">typedoc-github-theme</a></p></footer><div class="overlay"></div></body></html>
