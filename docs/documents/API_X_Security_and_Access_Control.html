<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>API_X_Security_and_Access_Control | @evolutius/apix</title><meta name="description" content="Documentation for @evolutius/apix"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><link rel="stylesheet" href="../assets/typedoc-github-style.css"/></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">@evolutius/apix</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">@evolutius/apix</a></li><li><a href="API_X_Security_and_Access_Control.html">API_X_Security_and_Access_Control</a></li></ul></div><div class="tsd-panel tsd-typography"><p>API-X is designed to allow developers to implement secure endpoints with simplicity and flexibility. It allows developers to use one of several well tested authentication and authorization mechanisms, and provides options while abstracting the complicates details behind each approach.</p>
<p>API-X will ask developers simple questions such as:</p>
<ul>
<li>Who does this API Key belong to (a simple database read);</li>
<li>How much authority does this application have (with guidelines to take the guess work out of it).</li>
</ul>
<p>It will then use the answer to those questions to protect your API against malicious requests and provided access control for authorized requests.</p>
<a id="md:secure-transport-enforcement" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Secure Transport Enforcement<a href="#md:secure-transport-enforcement" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>API-X enforces the use of SSL / TLS encrypted endpoints. Each request received by the API-X manager will be verified to have come from an encrypted connection, and any request that doesn't meet this requirement is rejected. This is used to encourage all developers to use an encrypted connection.</p>
<p>When endpoints are not encrypted, anyone on the same network as any client can see the contents of a request and find attack vectors to compromise users, endpoints, and data.</p>
<p><em>Note: While API-X does enforce encrypted endpoints, it is still the developer's responsibility to enable SSL / TLS / HTTPS on their server. API-X will simply refuse to serve non-encrypted requests. Additionally, API-X provides a developer mode that temporarily disables this requirements. Developer mode is designed to help developers build fast. It disables many security mechanism and it is <strong>critical</strong> that it be disabled in a production environment.</em></p>
<blockquote>
<p>For more information on Developer Mode, see <code>ApiXManager.developerModeEnabled</code>.</p>
</blockquote>
<a id="md:request-integrity-verification" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Request Integrity Verification<a href="#md:request-integrity-verification" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Each request received by API-X will be verified to contain all required security fields, application verification, and access control prior to reaching the handler for your endpoint. This ensures that any request that reaches any endpoint is already a valid one, and handlers just need to perform verification on the value of required fields.</p>
<p>This removes most of the validation and verification burden away from the developers so that they can focus on the business logic of their endpoints.</p>
<a id="md:application-level-authentication" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Application-Level Authentication<a href="#md:application-level-authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Authentication is about <em>who</em> is making a request to an API. An API-X API only serves requests to authorized applications, and it takes steps a few steps to <em>identify</em> the application making each request. API-X uses Application Identity Verification to either serve or reject requests. Valid clients must provide a previously supplied API Key via the <code>X-API-Key</code> header:</p>
<pre><code><span class="hl-0">X</span><span class="hl-1">-</span><span class="hl-0">API</span><span class="hl-1">-</span><span class="hl-2">Key</span><span class="hl-1">: &lt;</span><span class="hl-3">api_key</span><span class="hl-1">&gt;</span>
</code><button>Copy</button></pre>

<p>API-X then will use a data manager ask developers a simple question:</p>
<blockquote>
<p>Who is this API Key?</p>
</blockquote>
<p>Most of the time, this will translate into a simple database read. Developers answer this question through a concrete implementation of an <code>ApiXDataManager</code> class, which requires a method that resolves this.</p>
<blockquote>
<p>For more details, see <code>ApiXDataManager</code> and <code>ApiXDataManager.getAppKeyForApiKey</code>.</p>
</blockquote>
<blockquote>
<p>For details on how to securely store API Keys on clients, see {@page  Securely_Store_Keys_on_iOS_Android_and_Web_Applications.md <em>Securely Store Keys on iOS, Android, and Web Applications</em> }.</p>
</blockquote>
<a id="md:request-authenticity-and-integrity" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Request Authenticity and Integrity<a href="#md:request-authenticity-and-integrity" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Even if a request comes from a presumed authenticated application, it does not mean that the request is fully trusted by API-X yet. Each request has a unique signature that a client provides, and this unique signature is used by API-X to verify that:</p>
<ol>
<li>The request indeed comes from the application that sends it;</li>
<li>The request has not been tampered with; and,</li>
<li>The request is not a replayed by an intermediate attacker.</li>
</ol>
<p>A client uses a unique secret key to sign the request, using the request's data, and the server uses a similar process to verify that the signature is valid.</p>
<a id="md:request-origin-verification" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Request Origin Verification<a href="#md:request-origin-verification" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Only the application that possess the signing key can generate a valid signature. When the server authenticates the application, it also uses information from that application to verify the request signature. If a third-party attempts to send a request, the signature will not be valid and the request will be rejected by API-X.</p>
<a id="md:request-integrity-verification-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Request Integrity Verification<a href="#md:request-integrity-verification-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The signature is based on a HMAC SHA-256 hash that includes details of the request such as:</p>
<ol>
<li>The endpoint of the request;</li>
<li>The date of the request;</li>
<li>The data in the body of the request;</li>
<li>Application-specific data; and,</li>
<li>A unique nonce.</li>
</ol>
<p>If any of the details in the request were to change and the same signature would be sent, then API-X would reject it as the signature wouldn't match. This prevents tampering with the request itself.</p>
<a id="md:request-replay-prevention" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Request Replay Prevention<a href="#md:request-replay-prevention" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>API-X invalidates each request signature after a single use to prevent relay attacks. If an attacker somehow gets a hold of the request and attempts to resend it with the same data to receive its response, API-X will reject it as the signature would have already been processed by the original request.</p>
<p>In addition, each request is accompanied by a date. This date is a UTC timestamp that represents the date in which a request was created. API-X takes steps to invalidate old requests. By default, any request older than 1 minute is rejected, however, this value is configurable.</p>
<p>However, it's also important that each legitimate request is serviced, therefore, a unique nonce value is included with each request. A Nonce is a randomly generated value and the client generates it and uses it in the computation of the signature, ensuring its uniqueness. Even two clients make a similar request at the same time, the nonce would be different, thus resulting in a different signature.</p>
<a id="md:signing-a-request" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signing a Request<a href="#md:signing-a-request" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>A client sends a signature using HTTP headers for security:</p>
<pre><code><span class="hl-0">X</span><span class="hl-1">-</span><span class="hl-2">Signature</span><span class="hl-1">: &lt;</span><span class="hl-3">unique</span><span class="hl-1"> </span><span class="hl-3">signature</span><span class="hl-1">&gt;</span><br/><span class="hl-0">X</span><span class="hl-1">-</span><span class="hl-4">Signature</span><span class="hl-1">-</span><span class="hl-2">Nonce</span><span class="hl-1">: &lt;</span><span class="hl-3">nonce</span><span class="hl-1">&gt;</span><br/><span class="hl-2">Date</span><span class="hl-1">: &lt;</span><span class="hl-3">UTC</span><span class="hl-1"> </span><span class="hl-3">Date</span><span class="hl-1"> / </span><span class="hl-3">Timestamp</span><span class="hl-1">&gt;</span>
</code><button>Copy</button></pre>

<blockquote>
<p>For details on how to securely store cryptographic keys on clients, see {@page  Securely_Store_Keys_on_iOS_Android_and_Web_Applications.md <em>Securely Store Keys on iOS, Android, and Web Applications</em> }.</p>
</blockquote>
<a id="md:access-control" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Access Control<a href="#md:access-control" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>API-X provides an access control mechanism that developers use to:</p>
<ol>
<li>Determine which applications have access to what resources / endpoints; and,</li>
<li>Determine <em>how much</em> access each application has to each resources.</li>
</ol>
<p>This mechanism is called <em>Clearance Levels</em>. Clearance levels allow developers to specify the level of permission required to access each endpoint, as well as how much data each level of permission affords for a given endpoint.</p>
<p>To enable this mechanism, API-X asks 2 questions to developers:</p>
<ol>
<li>What clearance level is required for your endpoint?</li>
<li>What clearance level does <em>this</em> request has for <em>that</em> endpoint?</li>
</ol>
<p>The first is asked when creating the endpoint, providing fixed but concrete permission requirements for the endpoint. The second question is asked during the course of an ongoing request. This provides developers with flexibility to setup their own permission requirements per request, and integrate with industry standard authorization mechanisms like JSON Web Tokens (JWTs) and OAuth 2.0.</p>
<p>Clearance levels do <em>not</em> replace JWTs, OAuth 2.0, OpenID Connect, nor any other of the industry standard mechanisms, but rather they can work together to provide clear permission expectations of your applications. API-X provides clear guidance and examples of which clearance level should be assigned to endpoints given the resources it grants access to, and how to assign clearance levels to requests considering aspects such as the nature of the resources, as well as the ownership relationship between requestor and data. API-X also provides examples on how to integrate clearance levels with JSON Web Tokens.</p>
<a id="md:application-registration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Application Registration<a href="#md:application-registration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>API-X works to secure endpoints by working for Authorized applications only. However, the application registration is specific to the use of APIs. For example, APIs designed to be used only by the owners is a private API, and the process to register applications can be quite simple. However, public APIs (APIs that other developers can use for their own applications) require different registration process that must also be secured. It's imperative that secret keys are <em>never</em> transmitted via a request, and as such, measures must be taken, such as using <em>Key Agreement Protocols</em>.</p>
<blockquote>
<p>For more details, see {@page  Securely_Registering_New_Applications.md <em>Securely Registering New Applications</em> }.</p>
</blockquote>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:secure-transport-enforcement"><span>Secure <wbr/>Transport <wbr/>Enforcement</span></a><a href="#md:request-integrity-verification"><span>Request <wbr/>Integrity <wbr/>Verification</span></a><a href="#md:application-level-authentication"><span>Application-<wbr/>Level <wbr/>Authentication</span></a><a href="#md:request-authenticity-and-integrity"><span>Request <wbr/>Authenticity and <wbr/>Integrity</span></a><ul><li><a href="#md:request-origin-verification"><span>Request <wbr/>Origin <wbr/>Verification</span></a></li><li><a href="#md:request-integrity-verification-1"><span>Request <wbr/>Integrity <wbr/>Verification</span></a></li><li><a href="#md:request-replay-prevention"><span>Request <wbr/>Replay <wbr/>Prevention</span></a></li><li><a href="#md:signing-a-request"><span>Signing a <wbr/>Request</span></a></li></ul><a href="#md:access-control"><span>Access <wbr/>Control</span></a><a href="#md:application-registration"><span>Application <wbr/>Registration</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>@evolutius/apix</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a> with <a href="https://github.com/KillerJulian/typedoc-github-theme" target="_blank">typedoc-github-theme</a></p></footer><div class="overlay"></div></body></html>
